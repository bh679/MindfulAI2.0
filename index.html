<!DOCTYPE html>
<html data-wf-domain="">
    <head>
        <script src="recorder.js"></script>
        <script src="transcriber.js"></script>
    </head>
    <body class="body">
        <!-- Input field for the OpenAI API key -->
        <label for="apiKey">OpenAI API Key:</label>
        <input type="password" id="apiKey">

        <!-- Button to start and stop recording -->
        <button id="recordButton">Start Recording</button>

        <!-- Divs to display the status message and the transcription -->
        <div id="statusMessage"></div>
        <div id="transcription"></div>

        <script>
            window.onload = function() {
                // Get the elements from the page
                const apiKeyInput = document.getElementById('apiKey');
                const recordButton = document.getElementById('recordButton');
                const statusMessage = document.getElementById('statusMessage');
                const transcriptionDiv = document.getElementById('transcription');

                // Create a new Recorder object
                const recorder = new Recorder(apiKeyInput, recordButton, statusMessage, transcriptionDiv);

                // Create a new Transcriber object
                const transcriber = new Transcriber(apiKeyInput, statusMessage, transcriptionDiv);

                // When the record button is clicked
                recordButton.onclick = function() {
                    RecordToText();
                };

                async function RecordToText() {
                    
                    if (recorder.recorder && recorder.recorder.state === 'recording') {
                        recorder.stopRecording();
                    } else {
                        recorder.recordAudio().then(chunks => {
                            transcriber.transcribeAudio(chunks).then(transcription => {
                                console.log(transcription);
                            });
                        });
                    }
                    
                }

            };
        </script>
    </body>
</html>
